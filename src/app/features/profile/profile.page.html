<section class="section">
  <div class="container">
    <p-card>
      <ng-container *ngIf="isLoggedIn(); else notAuth">
        <!-- Header -->
        <div class="header">
          <p-avatar
            shape="circle"
            styleClass="avatar"
            [label]="initials(userSig()?.full_name)">
          </p-avatar>

          <div class="meta">
            <h2 class="title">{{ userSig()?.full_name || 'Пользователь' }}</h2>
            <div class="chips">
              <p-tag
                [severity]="roleSeverity(userSig()?.role)"
                [value]="roleLabel(userSig()?.role)">
              </p-tag>
              <p-tag
                [severity]="statusSeverity(userSig()?.is_active)"
                [value]="userSig()?.is_active ? 'Активен' : 'Неактивен'">
              </p-tag>
            </div>
            <a class="email" [href]="'mailto:' + (userSig()?.email || '')">
              <i class="pi pi-at"></i>
              {{ userSig()?.email }}
            </a>
          </div>

          <div class="actions">
            <button pButton pTooltip="Выйти" icon="pi pi-sign-out" (click)="logout()" class="p-button-rounded p-button-text"></button>
          </div>
        </div>

        <p-divider></p-divider>

        <!-- Details grid -->
        <div class="grid">
          <div class="row">
            <div class="label"><i class="pi pi-verified"></i> Роль</div>
            <div class="value">{{ roleLabel(userSig()?.role) }}</div>
          </div>
          <div class="row">
            <div class="label"><i class="pi pi-phone"></i> Телефон</div>
            <div class="value">{{ userSig()?.phone || '—' }}</div>
          </div>
          <div class="row">
            <div class="label"><i class="pi pi-image"></i> Изображение</div>
            <div class="value">
              <ng-container *ngIf="userSig()?.image?.file_url; else noImg">
                <a [href]="userSig()?.image?.file_url" target="_blank">Открыть</a>
              </ng-container>
              <ng-template #noImg>—</ng-template>
            </div>
          </div>
        </div>

        <p-divider></p-divider>

        <!-- Timestamps -->
        <div class="timestamps">
          <span><i class="pi pi-clock"></i> Создан: {{ userSig()?.created_at | date:'medium' }}</span>
          <span><i class="pi pi-refresh"></i> Обновлён: {{ userSig()?.updated_at | date:'medium' }}</span>
        </div>
      </ng-container>

      <ng-template #notAuth>
        <div class="not-auth">
          <i class="pi pi-lock"></i>
          <p>Вы не авторизованы.</p>
        </div>
      </ng-template>
    </p-card>
  </div>
</section>
